# Global API settings
newsapi:
  api_key: ""
  language: "en"

mediastack:
  access_key: ""
  base_url: "http://api.mediastack.com/v1/news"
  delay: 60

openai:
  api_key: "sk-proj--"
  model: "gpt-3.5-turbo"
  max_tokens: 16000
  temperature: 0
# Apparently max tokens is 16385 but we're approximating at 4 chars per token so we'll dial it down to 16000

localai:
  "enabled": False  # If we just want to use open ai we can disable the local ai, especially since it doesn't work yet
  "min_ram": 16  # Minimum RAM in GB
  "min_cores": 8  # Minimum CPU cores
  "max_input_tokens": 2048  # Maximum input tokens
  "local_model": "Zyphra/Zamba2-2.7B-instruct"
  "cpu_model_name": "Zyphra/Zamba2-2.7B-instruct"
  # Also try facebook/bart-large-cnn
  #"local_model": "EleutherAI/gpt-neo-2.7B"  # GPU model name
  "local_model_path": "models/Zyphra"
  #"cpu_model_name": "EleutherAI/gpt-neo-2.7B"  # CPU model name
  "max_memory_mps": "6GB"  # at most 6 GB on the Vega 56
  "max_memory_cpu": "58GB"   # the rest on system RAM


# The number of images to get from the news source to look for women.
max_images: 3


# Prompts for OpenAI
prompts:
  classification: >-
    Does this article include a woman in a genuine leadership role?
    Answer only "yes" or “no”, but if you know the name of the woman, include it after "yes".
  short_summary: >-
    Summarize the following article snippet in two sentences:
  spin_genders: >-
    Please rewrite the following article “cleanly” under these exact rules:

    1. **If no women or girls play an important role**, skip all other steps and write a **two-sentence summary** (≤ 100 words).

    2. **Draft**
       • Remove all ads, subscription asks, boilerplate, and distractions.
       • Preserve every named woman or girl — her full name and all her quotes exactly — do not diminish her role.
       • Replace every male first name with its initial only (e.g. “Stephen Hunter” → “S. Hunter”). Do **not** alter women’s or girls’ names.
       • Omit any man who isn’t essential.
       • Remove all male pronouns—do **not** swap in “she/her”; simply rewrite to avoid them.

    3. **Enforce Length**
       • Final output **must** be **500 words or fewer**.
       • After drafting, count your words.
       • If you exceed 500, delete the least-critical sentences (starting with non-essential men) and recount.
       • Repeat until the word count is ≤ 500.

    4. **Faithful & Complete**
       • Maintain the original meaning, tone, and key facts.

    —
    **Original article:**

  clean_summary: >-
    Please create new version of the following article, removing ads, subscription
    prompts, boilerplate text, and distractions. It should be slightly shorter than the original, and no longer than 500 words.
    Ensure you include the core narrative, and the quotes and contributions of women, especially <leader_name>.
    ###

# Global defaults
default_summarize_selected: true   # apply clean_summary to all female_leader articles unless overridden

genderize:
  api_url: "https://api.genderize.io"

leadership_keywords:
  - CEO
  - president
  - minister
  - chair
  - director
  - founder
  - co-founder
  - leader
  - head
  - manager
  - executive
  - officer
  - principal
  - captain
  - commander
  - chief
  - boss
  - forewoman
  - foreman
  - superintendent
  - overseer
  - mayor
  - governor
  - chancellor
  - senator
  - representative
  - ambassador
  - diplomat
  - judge
  - magistrate
  - commissioner

# Define as many queries as you like:
#   - `q`: your NewsAPI query (supports quoted phrases, +/– prefixes, AND/OR/NOT)
#   - `classification`: whether to apply the female-leadership filter
#   - `fallback`: what to do with non-female-leadership articles
#       * show-full: include original
#       * short_summary: replace content with OpenAI summary
#       * spin-genders: rewrite via OpenAI with female spin
#       * exclude: drop it
queries:

  - name: Calgary
    provider: newsapi
    q: "Calgary"
    page_size: 10
    classification: false
    fallback: short_summary
    summarize_selected: true

  - name: Canada
    provider: mediastack
    q: "Canada"
    page_size: 35
    classification: true
    languages: en
    fallback: spin-genders  # Options: show-full, short_summary, spin-genders, exclude
    summarize_selected: true
#    countries: ca doesn't work
#    history_days: 5       History seems to not work at least not the way we're doing it with the free API tier.

  - name: Global News
    provider: newsapi
    q: 'Global News'
    page_size: 100
    history_days: 5       # override default: grab the last 14 days
    classification: true
    fallback: exclude  # Options: show-full, short_summary, spin-genders, exclude
    fallback_image_female: short_summary     # if a woman’s face is prominent
    summarize_selected: true

  - name: Canada Women
    provider: newsapi
    q: '"Canada" and ("woman" or "women" or "girl")'
    page_size: 50
    classification: true
    fallback: exclude  # Options: show-full, short_summary, spin-genders, exclude
    fallback_image_female: short_summary     # if a woman’s face is prominent
    summarize_selected: true

  - name: Skiing
    provider: newsapi
    q: '"Skiing"'
    page_size: 25
    classification: true
    fallback: short_summary  # Options: show-full, short_summary, spin-genders, exclude
    fallback_image_female: show-full     # if a woman’s face is prominent
    summarize_selected: true

  - name: Trombone
    provider: newsapi
    q: '"Trombone"'
    page_size: 20
    classification: true
    fallback: short_summary  # Options: show-full, short_summary, spin-genders, exclude
    fallback_image_female: show-full     # if a woman’s face is prominent
    summarize_selected: true
